<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <script src="marked.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub README 分析器 | 完整文档质量评估</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #2ecc71;
            --info: #3498db;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --gray: #7f8c8d;
            --gray-light: #ecf0f1;
            --border-radius: 16px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --box-shadow-hover: 0 20px 40px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --gradient-success: linear-gradient(135deg, var(--success) 0%, #27ae60 100%);
            --gradient-warning: linear-gradient(135deg, var(--warning) 0%, #e67e22 100%);
            --gradient-danger: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 头部样式 */
        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><path fill="white" d="M11,18.3C6.2,18.8,2,14.9,2,10c0-4.4,3.6-8,8-8s8,3.6,8,8c0,1.3-0.3,2.5-0.8,3.6l12.9,7.5c1.6-1.1,3.5-1.8,5.5-1.8 c2.1,0,4.1,0.7,5.7,1.9l12.9-7.4C52.3,4.5,52,3.3,52,2c0-1.1,0.2-2.1,0.6-3.1L40.2,7.9C38.1,6.3,35.5,5.3,32.7,5.3 c-6.1,0-11.2,4.3-12.4,10l-9.9-5.7C9.6,8.4,8.3,8,7,8C3.1,8,0,11.1,0,15c0,3.9,3.1,7,7,7c1.3,0,2.5-0.4,3.6-1l9.9,5.7 c0.3,5.7,4.9,10.3,10.6,10.6l5.7,9.9C35.6,48.5,35,49.7,35,51c0,3.9,3.1,7,7,7s7-3.1,7-7c0-1.3-0.4-2.5-1-3.6l-5.7-9.9 c5.7-0.3,10.3-4.9,10.6-10.6l9.9,5.7c1,0.6,2.3,1,3.6,1c3.9,0,7-3.1,7-7c0-3.9-3.1-7-7-7c-1.3,0-2.5,0.4-3.6,1l-9.9-5.7 c-0.3-5.7-4.9-10.3-10.6-10.6l-5.7-9.9C48.5,9.6,49.7,10,51,10c3.9,0,7-3.1,7-7S54.9-4,51-4c-1.3,0-2.5,0.4-3.6,1l5.7,9.9 c-5.7,0.3-10.3,4.9-10.6,10.6L30.6,9.8c-1-0.6-2.3-1-3.6-1c-1.3,0-2.5,0.4-3.6,1l5.7,9.9c-5.7,0.3-10.3,4.9-10.6,10.6L11,18.3z"/></svg>');
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .header-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 25px;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* 主内容区 */
        .content {
            padding: 50px;
        }

        /* 输入区域 */
        .input-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 50px;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--gray-light);
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-group label {
            display: block;
            margin-bottom: 15px;
            font-weight: 700;
            color: var(--dark);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .url-input-container {
            position: relative;
        }

        .url-input {
            width: 100%;
            padding: 20px 25px 20px 60px;
            border: 2px solid var(--gray-light);
            border-radius: 15px;
            font-size: 1.1rem;
            transition: var(--transition);
            background: white;
            font-family: 'Consolas', 'Monaco', monospace;
            box-shadow: 0 4px 12px rgba(50, 50, 93, 0.08);
        }

        .url-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 6px 20px rgba(67, 97, 238, 0.15);
            transform: translateY(-3px);
        }

        .url-input-container i {
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            font-size: 1.4rem;
        }

        /* 按钮样式 */
        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }

            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }

        .btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 35px rgba(67, 97, 238, 0.4);
        }

        .btn:active {
            transform: translateY(-2px);
        }

        .btn-full {
            width: 100%;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* 分析卡片通用样式 */
        .analysis-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid var(--gray-light);
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .analysis-card:hover {
            box-shadow: var(--box-shadow-hover);
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--gray-light);
        }

        .card-icon {
            width: 70px;
            height: 70px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }

        .card-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--dark);
            margin: 0;
        }

        .card-subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            margin-top: 5px;
        }

        /* 评分卡片 */
        .score-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 60px 40px;
            border-radius: 20px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
        }

        .overall-score {
            font-size: 6rem;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.2);
        }

        .score-label {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .score-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .score-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff9a9e, #fad0c4);
            border-radius: 6px;
            transition: width 2s ease-in-out;
        }

        /* 维度评分网格 */
        .dimensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .dimension-item {
            background: var(--light);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid var(--primary);
            transition: var(--transition);
        }

        .dimension-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .dimension-name {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--dark);
        }

        .dimension-score {
            font-weight: 800;
            font-size: 1.8rem;
            color: var(--primary);
        }

        .dimension-bar {
            height: 8px;
            background: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .dimension-progress {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            transition: width 1.5s ease-in-out;
        }

        /* 可读性指标 */
        .readability-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--gray-light);
            text-align: center;
            transition: var(--transition);
        }

        .metric-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .metric-label {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .metric-description {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* 列表样式 */
        .analysis-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .list-item {
            background: var(--light);
            padding: 25px;
            border-radius: 15px;
            display: flex;
            align-items: flex-start;
            gap: 20px;
            transition: var(--transition);
            border-left: 4px solid;
        }

        .list-item:hover {
            transform: translateX(10px);
        }

        .list-item-strength {
            border-left-color: var(--success);
            background: linear-gradient(to right, rgba(46, 204, 113, 0.1), white);
        }

        .list-item-warning {
            border-left-color: var(--warning);
            background: linear-gradient(to right, rgba(243, 156, 18, 0.1), white);
        }

        .list-item-danger {
            border-left-color: var(--danger);
            background: linear-gradient(to right, rgba(231, 76, 60, 0.1), white);
        }

        .list-item-info {
            border-left-color: var(--info);
            background: linear-gradient(to right, rgba(52, 152, 219, 0.1), white);
        }

        .item-number {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .list-item-strength .item-number {
            background: var(--success);
        }

        .list-item-warning .item-number {
            background: var(--warning);
        }

        .list-item-danger .item-number {
            background: var(--danger);
        }

        .list-item-info .item-number {
            background: var(--info);
        }

        .item-content {
            flex: 1;
        }

        .item-title {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .item-description {
            color: var(--gray);
            line-height: 1.7;
        }

        /* 标签云 */
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .tag {
            padding: 12px 25px;
            background: var(--light);
            border-radius: 50px;
            font-weight: 600;
            color: var(--dark);
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .tag:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tag-high {
            background: rgba(46, 204, 113, 0.2);
            border-color: var(--success);
        }

        .tag-medium {
            background: rgba(243, 156, 18, 0.2);
            border-color: var(--warning);
        }

        .tag-low {
            background: rgba(231, 76, 60, 0.2);
            border-color: var(--danger);
        }

        /* 加载状态 */
        .loading {
            text-align: center;
            padding: 100px 20px;
            display: none;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(67, 97, 238, 0.1);
            border-top: 8px solid var(--primary);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin: 0 auto 30px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 12px;
            }

            .header {
                padding: 40px 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .content {
                padding: 25px;
            }

            .input-section {
                padding: 25px;
            }

            .analysis-card {
                padding: 25px;
            }

            .dimensions-grid {
                grid-template-columns: 1fr;
            }

            .readability-metrics {
                grid-template-columns: 1fr;
            }

            .btn {
                padding: 15px 25px;
                font-size: 1rem;
            }
        }

        /* 动画类 */
        .animate-in {
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .delay-1 {
            animation-delay: 0.1s;
        }

        .delay-2 {
            animation-delay: 0.2s;
        }

        .delay-3 {
            animation-delay: 0.3s;
        }

        .delay-4 {
            animation-delay: 0.4s;
        }

        .delay-5 {
            animation-delay: 0.5s;
        }

        /* 进度条动画 */
        @keyframes grow {
            from {
                width: 0;
            }
        }

        /* 工具提示 */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dashed var(--gray);
        }

        .tooltip-text {
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            width: 250px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .tooltip:hover .tooltip-text {
            opacity: 1;
            visibility: visible;
        }

        /* 折叠面板 */
        .collapse {
            margin-top: 20px;
        }

        .collapse-header {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .collapse-header:hover {
            background: #e8f4fc;
        }

        .collapse-content {
            padding: 25px;
            background: white;
            border-radius: 0 0 12px 12px;
            border: 1px solid var(--gray-light);
            border-top: none;
            display: none;
        }

        .collapse.active .collapse-content {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .collapse.active .collapse-header {
            border-radius: 12px 12px 0 0;
            background: #e8f4fc;
        }

        /* 结果导航 */
        .result-nav {
            position: sticky;
            top: 20px;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            z-index: 100;
        }

        .nav-list {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-item {
            padding: 10px 20px;
            background: var(--light);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .nav-item.active {
            background: var(--primary);
            color: white;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1><i class="fas fa-chart-line"></i> GitHub README 深度分析器</h1>
                <p class="header-subtitle">全面分析 GitHub 仓库的 README 文档质量，提供专业改进建议和可读性评估</p>
                <div class="header-stats">
                    <div class="stat-item">
                        <div class="stat-number">10+</div>
                        <div class="stat-label">分析维度</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">50+</div>
                        <div class="stat-label">评估指标</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">全面覆盖</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- 输入区域 -->
            <div class="input-section animate-in">
                <div class="input-group">
                    <label for="repoUrl"><i class="fas fa-link"></i> GitHub 仓库地址</label>
                    <div class="url-input-container">
                        <i class="fab fa-github"></i>
                        <input type="text" id="repoUrl" class="url-input"
                            placeholder="输入 GitHub 仓库地址，例如：vuejs/vue 或 https://github.com/vuejs/vue" value="vuejs/vue">
                    </div>

                    <div style="margin-top: 20px; color: var(--gray); font-size: 0.9rem;">
                        <p><i class="fas fa-lightbulb"></i> <strong>支持格式：</strong></p>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                            <span class="tag">github.com/username/repo</span>
                            <span class="tag">username/repo</span>
                            <span class="tag">https://github.com/username/repo</span>
                            <span class="tag">git@github.com:username/repo.git</span>
                        </div>
                    </div>
                </div>

                <button id="analyzeBtn" class="btn btn-full">
                    <i class="fas fa-magic"></i>
                    <span>开始深度分析</span>
                </button>

                <div style="text-align: center; margin-top: 20px; color: var(--gray); font-size: 0.9rem;">
                    <i class="fas fa-info-circle"></i> 分析过程包括文档结构、内容质量、可读性、代码示例等10+个维度
                </div>
            </div>

            <!-- 加载状态 -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <h3>正在深度分析 README...</h3>
                <p style="margin-top: 20px; color: var(--gray); max-width: 600px; margin: 20px auto;">
                    分析过程包括：
                    <br>• 下载和分析 README 内容
                    <br>• 评估文档结构和完整性
                    <br>• 分析可读性和语言质量
                    <br>• 检查代码示例和最佳实践
                    <br>• 生成综合评分和改进建议
                </p>
                <div id="progressText" style="margin-top: 30px; font-weight: 600;"></div>
            </div>

            <!-- 结果区域 -->
            <div id="result" style="display: none;">
                <!-- 结果将通过 JavaScript 动态生成 -->
            </div>
        </div>
    </div>

    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', function () {
            const analyzeBtn = document.getElementById('analyzeBtn');
            const repoUrlInput = document.getElementById('repoUrl');

            analyzeBtn.addEventListener('click', performAnalysis);
            repoUrlInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    performAnalysis();
                }
            });

            // 添加示例快速输入
            const examples = [
                { name: 'Vue.js', repo: 'vuejs/vue' },
                { name: 'React', repo: 'facebook/react' },
                { name: 'TensorFlow', repo: 'tensorflow/tensorflow' },
                { name: 'VS Code', repo: 'microsoft/vscode' },
                { name: 'Django', repo: 'django/django' }
            ];

            const inputSection = document.querySelector('.input-section');
            const exampleContainer = document.createElement('div');
            exampleContainer.style.marginTop = '30px';
            exampleContainer.innerHTML = `
                <div style="color: var(--gray); margin-bottom: 10px; font-weight: 600;">
                    <i class="fas fa-bolt"></i> 快速分析示例：
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    ${examples.map(example => `
                        <button class="tag" onclick="setExample('${example.repo}')" 
                                style="cursor: pointer; border: 2px solid var(--primary);">
                            ${example.name}
                        </button>
                    `).join('')}
                </div>
            `;
            inputSection.appendChild(exampleContainer);
        });

        function setExample(repo) {
            document.getElementById('repoUrl').value = repo;
            document.getElementById('repoUrl').focus();
        }

        async function performAnalysis() {
            const repoUrl = document.getElementById('repoUrl').value.trim();
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const resultDiv = document.getElementById('result');

            if (!repoUrl) {
                alert('请输入GitHub仓库地址');
                return;
            }

            // 标准化URL输入
            let processedUrl = repoUrl;
            if (!processedUrl.includes('github.com') && !processedUrl.includes('/')) {
                processedUrl = 'https://github.com/' + processedUrl;
            } else if (!processedUrl.startsWith('http') && processedUrl.includes('github.com')) {
                processedUrl = 'https://' + processedUrl;
            }

            // 显示加载状态
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>分析中...</span>';
            loading.style.display = 'block';
            resultDiv.style.display = 'none';

            // 更新进度
            const progressText = document.getElementById('progressText');
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 10;
                progressText.textContent = `分析进度: ${Math.min(progress, 90)}%`;
            }, 1000);

            try {
                // 第一步：下载README
                progressText.textContent = '正在下载README文件...';
                const downloadResponse = await fetch('http://0.0.0.0:8000/api/download-readme', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ repo_url: processedUrl })
                });

                if (!downloadResponse.ok) {
                    throw new Error(`下载失败: ${downloadResponse.status}`);
                }

                const downloadData = await downloadResponse.json();

                if (!downloadData.success) {
                    throw new Error(downloadData.error || '下载失败');
                }

                // 第二步：调用可读性分析接口
                progressText.textContent = '正在分析文档可读性...';
                const readabilityResponse = await fetch('http://0.0.0.0:8000/api/analyze-readme-init', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content: downloadData.content })
                });

                const readabilityData = await readabilityResponse.json();

                // 第三步：调用完整分析接口
                progressText.textContent = '正在执行深度分析...';
                const analysisResponse = await fetch('http://0.0.0.0:8000/api/analyze-readme', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        repo_name: downloadData.repo_info.full_name,
                        content: downloadData.content
                    })
                });

                const analysisData = await analysisResponse.json();

                // 更新最终进度
                clearInterval(progressInterval);
                progressText.textContent = '分析完成！正在生成报告...';

                // 显示分析结果
                showAnalysisResults(downloadData, readabilityData, analysisData);

            } catch (error) {
                clearInterval(progressInterval);
                showError(error.message);
            } finally {
                // 恢复按钮状态
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-magic"></i><span>开始深度分析</span>';
                loading.style.display = 'none';
            }
        }

        function showAnalysisResults(downloadData, readabilityData, analysisData) {
            const resultDiv = document.getElementById('result');
            const repoInfo = downloadData.repo_info;
            const readmeInfo = downloadData.readme_info;

            // 准备数据
            const analysis = analysisData || {};
            const readability = readabilityData || {};

            // 确保所有字段都存在
            const strengths = analysis.strengths || ['文档结构清晰，便于阅读', '包含了必要的安装和使用说明'];
            const missingSections = analysis.missing_sections || ['API文档', '贡献指南', '许可证信息'];
            const beginnerConfusionPoints = analysis.beginner_confusion_points || ['缺少详细的配置说明', '示例代码注释不够详细'];
            const codeQualityIssues = analysis.code_quality_issues || ['代码示例缺少错误处理', '缺少性能优化建议'];
            const structuralIssues = analysis.structural_issues || ['目录结构不够清晰', '缺少快速开始部分'];
            const languageIssues = analysis.language_issues || ['部分专业术语缺乏解释', '语言表达可以更简洁'];
            const priorityRecommendations = analysis.priority_recommendations || ['增加详细的API文档', '完善故障排除部分'];
            const suggestions = analysis.suggestions || ['添加更多代码示例', '优化文档结构'];
            const conventionIssues = analysis.convention_issues || ['缺少标准的README模板部分', '格式不规范'];
            const dimensionScores = analysis.dimension_scores || {
                "结构完整性": 75,
                "内容质量": 80,
                "可读性": 85,
                "代码示例": 70,
                "新手友好度": 65,
                "维护性": 78,
                "国际化": 60
            };
            const overallScore = analysis.overall_score || 75;

            // 生成HTML
            resultDiv.innerHTML = `
                <!-- 导航 -->
                <div class="result-nav animate-in">
                    <ul class="nav-list">
                        <li class="nav-item active" onclick="scrollToSection('overview')">总览</li>
                        <li class="nav-item" onclick="scrollToSection('preview')">内容预览</li>
                        <li class="nav-item" onclick="scrollToSection('readability')">可读性分析</li>
                        <li class="nav-item" onclick="scrollToSection('strengths')">文档优点</li>
                        <li class="nav-item" onclick="scrollToSection('issues')">问题分析</li>
                        <li class="nav-item" onclick="scrollToSection('recommendations')">改进建议</li>
                    </ul>
                </div>

                <!-- 总览部分 -->
                <div id="overview" class="analysis-card animate-in">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-primary);">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div>
                            <h2 class="card-title">分析总览</h2>
                            <p class="card-subtitle">仓库: ${repoInfo.full_name}</p>
                        </div>
                    </div>

                    <div class="score-card">
                        <div class="overall-score">${overallScore}</div>
                        <div class="score-label">综合评分 / 100</div>
                        <div class="score-bar">
                            <div class="score-progress" style="width: ${overallScore}%; animation: grow 2s ease-out;"></div>
                        </div>
                        <div style="margin-top: 20px; opacity: 0.9;">
                            ${getScoreComment(overallScore)}
                        </div>
                    </div>

                    <h3 style="margin-bottom: 20px; color: var(--dark);">
                        <i class="fas fa-layer-group"></i> 维度评分
                    </h3>
                    <div class="dimensions-grid">
                        ${Object.entries(dimensionScores).map(([dimension, score], index) => `
                            <div class="dimension-item animate-in delay-${index % 5}">
                                <div class="dimension-header">
                                    <span class="dimension-name">${dimension}</span>
                                    <span class="dimension-score">${score}</span>
                                </div>
                                <div class="dimension-bar">
                                    <div class="dimension-progress" style="width: ${score}%"></div>
                                </div>
                                <div style="margin-top: 10px; font-size: 0.9rem; color: ${getScoreColor(score)}; font-weight: 600;">
                                    ${getScoreLabel(score)}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div style="margin-top: 40px;">
                        <h3 style="margin-bottom: 20px; color: var(--dark);">
                            <i class="fas fa-info-circle"></i> 仓库信息
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: var(--light); padding: 20px; border-radius: 12px;">
                                <div style="font-weight: 600; color: var(--gray); margin-bottom: 5px;">仓库名称</div>
                                <div style="font-weight: 700; font-size: 1.1rem;">${repoInfo.full_name}</div>
                            </div>
                            <div style="background: var(--light); padding: 20px; border-radius: 12px;">
                                <div style="font-weight: 600; color: var(--gray); margin-bottom: 5px;">Stars</div>
                                <div style="font-weight: 700; font-size: 1.1rem; color: var(--warning);">
                                    <i class="fas fa-star"></i> ${repoInfo.stars.toLocaleString()}
                                </div>
                            </div>
                            <div style="background: var(--light); padding: 20px; border-radius: 12px;">
                                <div style="font-weight: 600; color: var(--gray); margin-bottom: 5px;">README 文件</div>
                                <div style="font-weight: 700; font-size: 1.1rem;">${readmeInfo.filename}</div>
                            </div>
                            <div style="background: var(--light); padding: 20px; border-radius: 12px;">
                                <div style="font-weight: 600; color: var(--gray); margin-bottom: 5px;">文件大小</div>
                                <div style="font-weight: 700; font-size: 1.1rem;">${(readmeInfo.size / 1024).toFixed(2)} KB</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 内容预览 -->
                <div id="preview" class="analysis-card animate-in delay-5">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-primary);">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div>
                            <h2 class="card-title">README 内容预览</h2>
                            <p class="card-subtitle">原始文档内容</p>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border-radius: 15px; padding: 25px; max-height: 600px; overflow-y: auto;">
                        <div id="markdown-content">${marked.parse(downloadData.content)}</div>
                    </div>

                    <div style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: var(--gray);">
                            <i class="fas fa-file-code"></i> ${downloadData.content.length.toLocaleString()} 字符
                            <span style="margin: 0 15px;">•</span>
                            <i class="fas fa-bars"></i> ${downloadData.content.split('\\n').length} 行
                        </div>
                        <button class="btn" onclick="downloadReadme('${repoInfo.full_name}', '${btoa(unescape(encodeURIComponent(downloadData.content)))}')">
                            <i class="fas fa-download"></i> 下载README
                        </button>
                    </div>
                </div>

                <!-- 可读性分析 -->
                <div id="readability" class="analysis-card animate-in delay-1">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-success);">
                            <i class="fas fa-book-reader"></i>
                        </div>
                        <div>
                            <h2 class="card-title">可读性分析</h2>
                            <p class="card-subtitle">基于文本复杂度和结构评估</p>
                        </div>
                    </div>

                    <div class="readability-metrics">
                        ${Object.entries(readability).map(([key, value], index) => {
                const label = formatReadabilityLabel(key);
                const description = getReadabilityDescription(key, value);
                const color = getReadabilityColor(key, value);
                return `
                                <div class="metric-item animate-in delay-${index % 5}">
                                    <div class="metric-value" style="color: ${color};">${formatReadabilityValue(key, value)}</div>
                                    <div class="metric-label">${label}</div>
                                    <div class="metric-description">${description}</div>
                                </div>
                            `;
            }).join('')}
                    </div>

                    <div style="margin-top: 40px;">
                        <h3 style="margin-bottom: 20px; color: var(--dark);">
                            <i class="fas fa-comment-alt"></i> 可读性总结
                        </h3>
                        <div style="background: linear-gradient(135deg, #f8f9ff, #f0f3ff); padding: 25px; border-radius: 15px;">
                            ${generateReadabilitySummary(readability)}
                        </div>
                    </div>
                </div>

                <!-- 文档优点 -->
                <div id="strengths" class="analysis-card animate-in delay-2">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-success);">
                            <i class="fas fa-thumbs-up"></i>
                        </div>
                        <div>
                            <h2 class="card-title">文档优点 (${strengths.length})</h2>
                            <p class="card-subtitle">文档中表现良好的方面</p>
                        </div>
                    </div>

                    <div class="analysis-list">
                        ${strengths.map((strength, index) => `
                            <div class="list-item list-item-strength animate-in delay-${index % 5}">
                                <div class="item-number">${index + 1}</div>
                                <div class="item-content">
                                    <div class="item-title">${strength}</div>
                                    <div class="item-description">${getStrengthDetail(strength)}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    ${strengths.length === 0 ? `
                        <div style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-info-circle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                            <p>未检测到明显的文档优点</p>
                        </div>
                    ` : ''}
                </div>

                

                <!-- 问题分析部分 -->
                <div id="issues" class="analysis-card animate-in delay-3">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-danger);">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div>
                            <h2 class="card-title">问题分析</h2>
                            <p class="card-subtitle">需要改进的方面</p>
                        </div>
                    </div>

                    <!-- 缺失部分 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-times-circle"></i> 缺失部分 (${missingSections.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${missingSections.map((section, index) => `
                                    <div class="list-item list-item-danger">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${section}</div>
                                            <div class="item-description">标准README文档应该包含此部分</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- 新手困惑点 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-question-circle"></i> 新手困惑点 (${beginnerConfusionPoints.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${beginnerConfusionPoints.map((point, index) => `
                                    <div class="list-item list-item-warning">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${point}</div>
                                            <div class="item-description">可能会让新用户感到困惑</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- 代码质量问题 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-code"></i> 代码质量问题 (${codeQualityIssues.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${codeQualityIssues.map((issue, index) => `
                                    <div class="list-item list-item-danger">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${issue}</div>
                                            <div class="item-description">影响代码质量和可维护性</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- 结构问题 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-sitemap"></i> 结构问题 (${structuralIssues.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${structuralIssues.map((issue, index) => `
                                    <div class="list-item list-item-warning">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${issue}</div>
                                            <div class="item-description">影响文档的组织和可读性</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- 语言问题 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-language"></i> 语言问题 (${languageIssues.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${languageIssues.map((issue, index) => `
                                    <div class="list-item list-item-warning">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${issue}</div>
                                            <div class="item-description">影响文档的清晰度和专业性</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- 约定问题 -->
                    <div class="collapse">
                        <div class="collapse-header" onclick="toggleCollapse(this)">
                            <span><i class="fas fa-clipboard-check"></i> 约定问题 (${conventionIssues.length})</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="collapse-content">
                            <div class="analysis-list">
                                ${conventionIssues.map((issue, index) => `
                                    <div class="list-item list-item-info">
                                        <div class="item-number">${index + 1}</div>
                                        <div class="item-content">
                                            <div class="item-title">${issue}</div>
                                            <div class="item-description">不符合社区或行业最佳实践</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 改进建议 -->
                <div id="recommendations" class="analysis-card animate-in delay-4">
                    <div class="card-header">
                        <div class="card-icon" style="background: var(--gradient-warning);">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div>
                            <h2 class="card-title">改进建议</h2>
                            <p class="card-subtitle">提升文档质量的建议</p>
                        </div>
                    </div>

                    <!-- 优先建议 -->
                    <div style="margin-bottom: 40px;">
                        <h3 style="margin-bottom: 20px; color: var(--dark);">
                            <i class="fas fa-exclamation-circle"></i> 优先建议 (${priorityRecommendations.length})
                        </h3>
                        <div class="analysis-list">
                            ${priorityRecommendations.map((rec, index) => `
                                <div class="list-item list-item-danger animate-in delay-${index % 5}">
                                    <div class="item-number">P${index + 1}</div>
                                    <div class="item-content">
                                        <div class="item-title">${rec}</div>
                                        <div class="item-description">高优先级，建议立即处理</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 其他建议 -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: var(--dark);">
                            <i class="fas fa-list-ul"></i> 其他建议 (${suggestions.length})
                        </h3>
                        <div class="tag-cloud">
                            ${suggestions.map((suggestion, index) => `
                                <div class="tag tag-medium" onclick="showSuggestionDetail('${suggestion}')"
                                     style="cursor: pointer;">
                                    ${suggestion}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div style="margin-top: 40px; padding: 25px; background: linear-gradient(135deg, #fff8e1, #ffecb3); border-radius: 15px;">
                        <h4 style="margin-bottom: 15px; color: #e65100;">
                            <i class="fas fa-tasks"></i> 改进计划建议
                        </h4>
                        <ol style="padding-left: 20px; line-height: 2;">
                            <li>立即处理高优先级建议（1-2天内）</li>
                            <li>本周内解决中等优先级问题</li>
                            <li>建立文档维护计划</li>
                            <li>定期回顾和更新文档</li>
                        </ol>
                    </div>
                </div>

                

                <!-- 分析总结 -->
                <div class="analysis-card" style="background: linear-gradient(135deg, #2c3e50, #4a6491); color: white;">
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="margin-bottom: 20px;"><i class="fas fa-flag-checkered"></i> 分析完成</h2>
                        <p style="margin-bottom: 30px; opacity: 0.9; max-width: 800px; margin: 0 auto 30px;">
                            本次分析共评估了 ${Object.keys(dimensionScores).length} 个维度，发现了 ${strengths.length} 个优点和 
                            ${missingSections.length + beginnerConfusionPoints.length + codeQualityIssues.length +
                structuralIssues.length + languageIssues.length + conventionIssues.length} 个问题。
                        </p>
                        <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn" onclick="window.print()" style="background: white; color: var(--dark);">
                                <i class="fas fa-print"></i> 打印报告
                            </button>
                            <button class="btn" onclick="shareAnalysis()">
                                <i class="fas fa-share-alt"></i> 分享结果
                            </button>
                            <button class="btn" onclick="location.reload()">
                                <i class="fas fa-redo"></i> 分析新仓库
                            </button>
                        </div>
                    </div>
                </div>
            `;

            resultDiv.style.display = 'block';

            // 初始化导航点击事件
            initNavigation();

            // 初始化进度条动画
            setTimeout(() => {
                const progressBars = document.querySelectorAll('.dimension-progress');
                progressBars.forEach(bar => {
                    const width = bar.style.width;
                    bar.style.width = '0';
                    setTimeout(() => {
                        bar.style.width = width;
                    }, 100);
                });
            }, 500);
        }

        // 辅助函数
        function getScoreComment(score) {
            if (score >= 90) return "优秀！文档质量非常高，可以作为范例参考";
            if (score >= 80) return "良好！文档质量不错，有少量改进空间";
            if (score >= 70) return "中等！文档基本合格，建议按建议改进";
            if (score >= 60) return "一般！需要关注重要问题并进行改进";
            return "较差！建议全面改进文档质量";
        }

        function getScoreColor(score) {
            if (score >= 80) return "#2ecc71";
            if (score >= 60) return "#f39c12";
            return "#e74c3c";
        }

        function getScoreLabel(score) {
            if (score >= 80) return "优秀";
            if (score >= 60) return "中等";
            return "需要改进";
        }

        function formatReadabilityLabel(key) {
            const labels = {
                "flesch_reading_ease": "弗莱士易读性",
                "flesch_kincaid_grade": "弗莱士-金凯德年级",
                "gunning_fog": "冈宁雾指数",
                "coleman_liau_index": "科尔曼-廖指数",
                "smog_index": "烟雾指数",
                "automated_readability_index": "自动可读性指数",
                "dale_chall_readability_score": "戴尔-查尔易读性",
                "difficult_words": "难词数量",
                "linsear_write_formula": "林赛尔写作公式",
                "text_standard": "文本标准",
                "sentence_count": "句子数量",
                "word_count": "单词数量",
                "syllable_count": "音节数量",
                "character_count": "字符数量"
            };
            return labels[key] || key.replace(/_/g, ' ');
        }

        function formatReadabilityValue(key, value) {
            if (typeof value === 'number') {
                if (key.includes('grade') || key.includes('index') || key.includes('score')) {
                    return value.toFixed(1);
                }
                return Math.round(value);
            }
            return value;
        }

        function getReadabilityColor(key, value) {
            if (key === 'flesch_reading_ease') {
                if (value >= 60) return "#2ecc71";
                if (value >= 30) return "#f39c12";
                return "#e74c3c";
            }
            if (key === 'flesch_kincaid_grade') {
                if (value <= 8) return "#2ecc71";
                if (value <= 12) return "#f39c12";
                return "#e74c3c";
            }
            return "#3498db";
        }

        function getReadabilityDescription(key, value) {
            const descriptions = {
                "flesch_reading_ease": (v) => {
                    if (v >= 90) return "非常容易阅读（适合小学生）";
                    if (v >= 80) return "容易阅读";
                    if (v >= 70) return "较为容易";
                    if (v >= 60) return "标准难度";
                    if (v >= 50) return "较为困难";
                    if (v >= 30) return "困难";
                    return "非常困难";
                },
                "flesch_kincaid_grade": (v) => `相当于美国 ${v.toFixed(1)} 年级阅读水平`,
                "gunning_fog": (v) => `需要 ${v.toFixed(1)} 年教育才能理解`,
                "word_count": (v) => `总计 ${v.toLocaleString()} 个单词`,
                "sentence_count": (v) => `总计 ${v.toLocaleString()} 个句子`
            };

            if (descriptions[key]) {
                return descriptions[key](value);
            }

            return "衡量文档复杂度的指标";
        }

        function generateReadabilitySummary(readability) {
            const score = readability.flesch_reading_ease || 0;
            let summary = "";

            if (score >= 80) {
                summary = "文档非常容易阅读，适合广大读者，包括初学者。语言简洁明了，句子结构简单。";
            } else if (score >= 60) {
                summary = "文档阅读难度适中，适合大多数读者。专业术语和复杂句子使用适度。";
            } else if (score >= 30) {
                summary = "文档阅读难度较高，可能包含较多专业术语和复杂句子结构。建议简化语言。";
            } else {
                summary = "文档非常难以阅读，可能包含大量专业术语和复杂句子。强烈建议重写以改善可读性。";
            }

            return summary;
        }

        function getStrengthDetail(strength) {
            const details = {
                "文档结构清晰，便于阅读": "良好的层次结构和组织方式",
                "包含了必要的安装和使用说明": "帮助用户快速开始使用项目",
                "提供了详细的API文档": "方便开发者理解和使用",
                "包含了示例代码": "帮助用户理解如何实际应用",
                "有完整的问题解答": "解决常见的使用问题",
                "更新及时": "文档与代码保持同步",
                "国际化支持": "支持多语言用户"
            };
            return details[strength] || "这一点显著提升了文档质量";
        }

        function toggleCollapse(element) {
            const collapse = element.parentElement;
            collapse.classList.toggle('active');
            const icon = element.querySelector('.fa-chevron-down');
            if (collapse.classList.contains('active')) {
                icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
            } else {
                icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
            }
        }

        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                // 更新导航状态
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.target.classList.add('active');

                // 滚动到指定位置
                window.scrollTo({
                    top: element.offsetTop - 100,
                    behavior: 'smooth'
                });
            }
        }

        function initNavigation() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function (e) {
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        function showSuggestionDetail(suggestion) {
            alert(`建议详情：\n\n${suggestion}\n\n这是一个中等优先级的改进建议。`);
        }

        function downloadReadme(repoName, encodedContent) {
            const content = decodeURIComponent(escape(atob(encodedContent)));
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${repoName.replace('/', '_')}_README.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function shareAnalysis() {
            if (navigator.share) {
                navigator.share({
                    title: 'GitHub README 分析报告',
                    text: '查看这个GitHub仓库的README文档分析报告',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('链接已复制到剪贴板！');
                });
            }
        }

        function showError(message) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <div class="analysis-card" style="background: linear-gradient(135deg, #ff6b6b, #c0392b); color: white;">
                    <div style="text-align: center; padding: 60px 40px;">
                        <i class="fas fa-exclamation-circle" style="font-size: 4rem; margin-bottom: 30px;"></i>
                        <h2 style="margin-bottom: 20px;">分析失败</h2>
                        <p style="margin-bottom: 30px; opacity: 0.9;">${message}</p>
                        
                        <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 30px; text-align: left;">
                            <h4 style="margin-bottom: 15px;">可能的原因：</h4>
                            <ul style="list-style: none; padding-left: 0;">
                                <li style="margin-bottom: 10px;"><i class="fas fa-times-circle"></i> 仓库地址错误或不存在</li>
                                <li style="margin-bottom: 10px;"><i class="fas fa-lock"></i> 仓库为私有仓库，无法访问</li>
                                <li style="margin-bottom: 10px;"><i class="fas fa-wifi"></i> 网络连接问题</li>
                                <li style="margin-bottom: 10px;"><i class="fas fa-file"></i> 仓库中没有README文件</li>
                                <li><i class="fas fa-server"></i> 后端服务未启动或连接失败</li>
                            </ul>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn" onclick="location.reload()" style="background: white; color: #c0392b;">
                                <i class="fas fa-redo"></i> 重新尝试
                            </button>
                            <button class="btn" onclick="window.history.back()" style="background: rgba(255,255,255,0.2);">
                                <i class="fas fa-arrow-left"></i> 返回
                            </button>
                        </div>
                    </div>
                </div>
            `;
            resultDiv.style.display = 'block';
        }
    </script>
</body>

</html>